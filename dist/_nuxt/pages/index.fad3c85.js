(window.webpackJsonp=window.webpackJsonp||[]).push([[26,6,7,10,11],{1008:function(t,e,n){"use strict";n.r(e);var r=n(20),o=(n(87),n(78),n(33),n(57),n(969)),c=n(966),l=n(977),d=n(978),v={components:{WritePost:o.default,PostCard:c.default,NavOptionLeft:l.default,NavOptionRight:d.default},data:function(){return{showRight:!0,showLeft:!0,decks:[],loadMore:!1,pageSize:5,pageNumber:1}},fetch:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loadMore=!1,e.next=4,t.$axios.$get("/decks?pageSize=".concat(t.pageSize,"&pageNumber=1"));case 4:(n=e.sent).success&&(t.decks=n.decks,n.decks.length<t.pageSize&&(t.loadMore=!0),t.pageNumber=n.meta.pageNumber),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},head:function(){return{title:this.$t("Trang chủ")+" | PSA"}},mounted:function(){var t=this;this.$nextTick((function(){document.body.clientWidth<1200&&(t.showLeft=!1),document.body.clientWidth<992&&(t.showRight=!1),window.onresize=function(){document.body.clientWidth<1200?t.showLeft=!1:t.showLeft=!0,document.body.clientWidth<992?t.showRight=!1:t.showRight=!0}}))},methods:{fetchDeck:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.$get("/decks?pageSize=".concat(t.pageSize,"&pageNumber=").concat(t.pageNumber+1));case 3:(n=e.sent).success&&(t.decks=t.decks.concat(n.decks),t.pageNumber=n.meta.pageNumber,n.decks.length<t.pageSize&&(t.loadMore=!0)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},fetchDelete:function(t){this.decks=this.decks.filter((function(e){return e._id!==t}))}}},h=(n(983),n(27)),component=Object(h.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.$fetchState.pending?n("LoadingView"):n("main",{staticClass:"main-wrapper home"},[n("NavOptionLeft",{attrs:{show:t.showLeft}}),t._v(" "),n("NavOptionRight",{attrs:{show:t.showRight}}),t._v(" "),n("div",{staticClass:"container"},[n("div",{staticClass:"width-post"},[n("WritePost",{on:{fetchData:t.$fetch}}),t._v(" "),n("div",{staticClass:"list-post"},[t._l(t.decks,(function(e,r){return n("PostCard",{key:r,attrs:{deck:e},on:{fetchDelete:t.fetchDelete}})})),t._v(" "),n("scroll-loader",{attrs:{"loader-method":t.fetchDeck,"loader-disable":t.loadMore}},[n("div",{staticClass:"spinner"})])],2)],1)])],1)}),[],!1,null,"12ef0d15",null);e.default=component.exports;installComponents(component,{PostCard:n(966).default})},955:function(t,e,n){t.exports=n.p+"img/group-avt.ac787bc.jpg"},959:function(t,e,n){},965:function(t,e,n){"use strict";n(959)},966:function(t,e,n){"use strict";n.r(e);var r=n(20),o=(n(64),n(57),{props:{deck:{type:Object,default:function(){return{}}}},data:function(){return{post:this.deck,like:this.deck.like,body:"",postComments:[],current:1,pageSize:3}},watch:{deck:function(t){this.post=t}},created:function(){var t=this;this.socket.emit("Created",{user:this.$auth.user.userName}),this.socket.on("user-comment",(function(data){data.idPost===t.post._id&&t.post.reviews.push({body:data.bd,user:{_id:data.id,userName:data.user,avatar:data.avatar}})})),this.showMore()},mounted:function(){var t=this;this.$nextTick((function(){document.addEventListener("click",(function(e){t.$refs.menu&&(e.preventDefault(),t.$refs.menu.classList.remove("active"))}))}))},methods:{handleMenu:function(){event.stopPropagation(),this.$refs.menu.classList.toggle("active")},handleLike:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$axios.$post("/decks/"+t);case 3:n.sent.success&&e.fetchLike(t),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.error(n.t0);case 10:case"end":return n.stop()}}),n,null,[[0,7]])})))()},fetchLike:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$axios.$get("/decks/"+t);case 3:r=n.sent,e.like=r.deck.like,n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.error(n.t0);case 10:case"end":return n.stop()}}),n,null,[[0,7]])})))()},handleSave:function(){var t=this;this.$axios.$post("/api/auth/user/"+this.post._id).then((function(e){e.success&&(t.$notification.success({message:t.$t("Thông báo"),description:t.$t("Thay đổi thành công")}),t.$auth.fetchUser())})).catch((function(t){console.error(t)}))},onAddReview:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.body){e.next=14;break}return e.prev=1,t.socket.emit("user-comment",{bd:t.body,user:t.$auth.user.userName,avatar:t.$auth.user.avatar,id:t.$auth.user._id,idPost:t.post._id}),(data=new FormData).append("body",t.body),e.next=7,t.$axios.$post("/reviews/".concat(t.deck._id),data);case 7:e.sent.success&&(t.body=null),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})))()},handleDelete:function(){var t=this;this.$axios.$delete("/decks/"+this.deck._id).then((function(e){e.success&&(t.$notification.success({message:t.$t("Thông báo"),description:t.$t("Xóa thành công")}),t.$emit("fetchDelete",t.deck._id))})).catch((function(t){return console.error(t)}))},showMore:function(){var t=this.pageSize*this.current;t>this.post.reviews.length?t=this.post.reviews.length:this.current+=1,this.postComments=this.post.reviews.slice(0,t)}}}),c=n(27),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"post-card"},[r("div",{staticClass:"actor"},[r("div",{staticClass:"actor__avt"},[t.post.owner.avatar?r("img",{attrs:{src:t.post.owner.avatar,alt:"Avatar"}}):r("img",{attrs:{src:n(338),alt:""}})]),t._v(" "),r("div",{staticClass:"actor__name"},[r("div",{staticClass:"actor__name-text"},[t.post.owner._id===t.$auth.user._id?r("nuxt-link",{attrs:{to:"/profile"}},[t._v(t._s(t.post.owner.userName))]):r("nuxt-link",{attrs:{to:"/profile/"+t.post.owner._id}},[t._v(t._s(t.post.owner.userName))])],1),t._v(" "),r("div",{staticClass:"actor__name-time"},[t._v(t._s(t.post.date))])]),t._v(" "),r("div",{staticClass:"actor__action"},[r("ThreeDot",{nativeOn:{click:function(e){return t.handleMenu.apply(null,arguments)}}}),t._v(" "),r("div",{ref:"menu",staticClass:"menu"},[t.deck.owner._id===t.$auth.user._id?r("div",{staticClass:"menu__item"},[r("a-icon",{attrs:{type:"edit"}}),t._v("\n          "+t._s(t.$t("Chỉnh sửa"))+"\n        ")],1):t._e(),t._v(" "),t.deck.owner._id===t.$auth.user._id?r("div",{staticClass:"menu__item",on:{click:t.handleDelete}},[r("a-icon",{attrs:{type:"delete"}}),t._v("\n          "+t._s(t.$t("Xóa bài viết"))+"\n        ")],1):t._e(),t._v(" "),r("div",{staticClass:"menu__item"},[r("a-icon",{attrs:{type:"alert"}}),t._v("\n          "+t._s(t.$t("Báo cáo vi phạm"))+"\n        ")],1)])],1)]),t._v(" "),r("div",{staticClass:"image"},[r("client-only",[r("Lightbox",{attrs:{cells:3,items:t.post.image}})],1)],1),t._v(" "),r("div",{staticClass:"content"},[r("client-only",[r("vue-show-more-text",{attrs:{text:t.post.content,lines:4,"more-text":t.$t("Xem thêm"),"less-text":t.$t("Thu gọn"),"additional-anchor-css":"color: #EA4C89","additional-container-css":"padding: initial"}})],1)],1),t._v(" "),r("div",{staticClass:"bar"},[r("div",{staticClass:"bar__item",on:{click:function(e){return t.handleLike(t.post._id)}}},[-1===t.like.indexOf(t.$auth.user._id)?r("a-icon",{staticClass:"bar__item-icon",attrs:{type:"heart"}}):r("a-icon",{staticClass:"bar__item-icon",staticStyle:{color:"#d7443e"},attrs:{type:"heart",theme:"filled"}}),t._v(" "),r("p",[t._v(t._s(t.like.length)+" "+t._s(t.$t("Yêu thích")))])],1),t._v(" "),r("nuxt-link",{staticClass:"bar__item",attrs:{to:"/post/"+t.post._id}},[r("a-icon",{staticClass:"bar__item-icon",attrs:{type:"message"}}),t._v(" "),r("p",[t._v(t._s(t.post.reviews.length)+" "+t._s(t.$t("Bình luận")))])],1),t._v(" "),r("div",{staticClass:"bar__item",on:{click:t.handleSave}},[r("a-icon",{staticClass:"bar__item-icon",attrs:{type:"save"}}),t._v(" "),-1===t.$auth.user.deckShare.map((function(t){return t._id})).indexOf(t.post._id)?r("p",[t._v(t._s(t.$t("Lưu bài viết")))]):r("p",[t._v(t._s(t.$t("Bỏ lưu")))])],1)],1),t._v(" "),t.post.reviews.length>0?r("div",{staticClass:"comments"},[t._l(t.postComments,(function(e,o){return r("div",{key:o,staticClass:"comments__item"},[r("div",{staticClass:"comments__item-avt"},[e.user.avatar?r("img",{attrs:{src:e.user.avatar,alt:"avatar"}}):r("img",{attrs:{src:n(338),alt:"avatar"}})]),t._v(" "),r("div",{staticClass:"comments__item-content"},[e.user._id===t.$auth.user._id?r("nuxt-link",{staticClass:"name",attrs:{to:"/profile"}},[t._v("\n          "+t._s(e.user.userName)+"\n        ")]):r("nuxt-link",{staticClass:"name",attrs:{to:"/profile/"+e.user._id}},[t._v(t._s(e.user.userName))]),t._v(" "),r("div",{staticClass:"body",domProps:{innerHTML:t._s(e.body)}})],1)])})),t._v(" "),t.postComments.length<t.post.reviews.length?r("p",{staticClass:"comments__btn",on:{click:t.showMore}},[t._v(t._s(t.$t("Hiển thị thêm")))]):t._e()],2):t._e(),t._v(" "),r("div",{staticClass:"comment"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.body,expression:"body"}],staticClass:"comment__input",attrs:{type:"text",placeholder:t.$t("Viết bình luận")},domProps:{value:t.body},on:{input:function(e){e.target.composing||(t.body=e.target.value)}}}),t._v(" "),r("i",{staticClass:"fas fa-paper-plane icon",on:{click:t.onAddReview}})])])}),[],!1,null,null,null);e.default=component.exports},969:function(t,e,n){"use strict";n.r(e);var r=n(20);n(57),n(33),n(198),n(50),n(629);function o(t){return new Promise((function(e,n){var r=new FileReader;r.readAsDataURL(t),r.onload=function(){return e(r.result)},r.onerror=function(t){return n(t)}}))}var c={props:{api:{type:String,default:"/decks"}},data:function(){return{visibleModal:!1,disableBtn:!0,previewVisible:!1,previewImage:"",fileList:[],showEmoji:!1,btnLoading:!1}},methods:{handleOpenModal:function(){this.visibleModal=!0},handleCloseModal:function(){this.visibleModal=!1,this.fileList=[],this.$refs.contentPost.innerHTML="",this.showEmoji=!1,this.disableBtn=!0},handleEmoji:function(){this.showEmoji=!this.showEmoji},handleCancel:function(){this.previewVisible=!1},changeText:function(t){""!==t.target.innerHTML||0!==this.fileList.length?this.disableBtn=!1:this.disableBtn=!0},selectEmoji:function(t){var e=document.createTextNode(t.data);this.$refs.contentPost.appendChild(e),this.disableBtn=!1},dummyRequest:function(t){setTimeout((function(){t.onSuccess("ok")}),0)},handlePreview:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.url||t.preview){n.next=4;break}return n.next=3,o(t.originFileObj);case 3:t.preview=n.sent;case 4:e.previewImage=t.url||t.preview,e.previewVisible=!0;case 6:case"end":return n.stop()}}),n)})))()},handleChange:function(t){var e=this;this.fileList=t.fileList,"done"===t.file.status&&t.fileList.forEach((function(t,n){t.size/1024/1024>2&&(e.fileList.splice(n,1),e.$message.error("Ảnh phải bé hơn 2MB!"))})),"removed"===t.file.status&&(this.fileList=t.fileList),0!==this.fileList.length||""!==this.$refs.contentPost.innerHTML?this.disableBtn=!1:this.disableBtn=!0},handleSubmit:function(){var t=this;this.btnLoading=!0;var e=new FormData;e.append("content",this.$refs.contentPost.innerHTML),this.fileList.forEach((function(t){e.append("image",t.originFileObj)})),this.$axios.$post(this.api,e).then((function(e){e.success&&(t.$emit("fetchData"),t.btnLoading=!1,t.handleCloseModal())})).catch((function(e){console.error(e),t.btnLoading=!1}))}}},l=(n(965),n(27)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"write-post",on:{click:t.handleOpenModal}},[r("div",{staticClass:"avatar"},[t.$auth.user.avatar?r("img",{attrs:{src:t.$auth.user.avatar,alt:"avatar"}}):r("img",{attrs:{src:n(338),alt:"avatar"}})]),t._v(" "),r("div",{staticClass:"placeholder"},[t._v(t._s(t.$t("Hôm nay bạn ổn không")))]),t._v(" "),t._m(0),t._v(" "),r("a-modal",{staticClass:"modal-post",attrs:{title:t.$t("Bài viết mới"),width:"670px",footer:!1},on:{cancel:t.handleCloseModal},model:{value:t.visibleModal,callback:function(e){t.visibleModal=e},expression:"visibleModal"}},[r("template",{slot:"closeIcon"},[r("i",{staticClass:"fal fa-times icon"})]),t._v(" "),r("div",{staticClass:"user"},[r("div",{staticClass:"user__avt"},[t.$auth.user.avatar?r("img",{attrs:{src:t.$auth.user.avatar,alt:"avatar"}}):r("img",{attrs:{src:n(338),alt:"avatar"}})]),t._v(" "),r("div",{staticClass:"user__name"},[t._v(t._s(t.$auth.user.userName))])]),t._v(" "),r("div",{staticClass:"content"},[r("div",{ref:"contentPost",staticClass:"content__text",attrs:{contenteditable:"true","data-place":t.$t("Bạn đang nghĩ gì")},on:{input:t.changeText}}),t._v(" "),r("div",{staticClass:"more"},[r("div",{staticClass:"img",on:{click:function(e){return t.$refs.image.click()}}},[r("i",{staticClass:"fas fa-images icon"})]),t._v(" "),r("div",{on:{click:t.handleEmoji}},[r("i",{staticClass:"fas fa-smile icon"})]),t._v(" "),t.showEmoji?r("VEmojiPicker",{on:{select:t.selectEmoji}}):t._e()],1)]),t._v(" "),r("a-upload",{attrs:{"list-type":"picture-card",accept:".png, .jpg, .jpeg",multiple:!0,"custom-request":t.dummyRequest,"file-list":t.fileList},on:{preview:t.handlePreview,change:t.handleChange}},[r("button",{ref:"image"},[t._v("click")])]),t._v(" "),r("a-modal",{attrs:{visible:t.previewVisible,footer:null},on:{cancel:t.handleCancel}},[r("template",{slot:"closeIcon"},[r("i",{staticClass:"fal fa-times icon"})]),t._v(" "),r("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:t.previewImage}})],2),t._v(" "),r("a-button",{key:"submit",attrs:{block:"",size:"large",type:"primary",loading:t.btnLoading,disabled:t.disableBtn},on:{click:t.handleSubmit}},[t._v("\n      "+t._s(t.$t("Đăng bài"))+"\n    ")])],2)],1)}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"emoji"},[n("i",{staticClass:"fas fa-images icon"}),t._v(" "),n("i",{staticClass:"fas fa-smile icon"})])}],!1,null,"3d99a7ae",null);e.default=component.exports},975:function(t,e,n){},977:function(t,e,n){"use strict";n.r(e);var r={props:{show:{type:Boolean,default:!0}}},o=n(27),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.show?r("div",{staticClass:"nav-option left"},[r("div",{staticClass:"group"},[r("div",{staticClass:"title"},[r("p",[t._v(t._s(t.$t("Nhóm")))]),t._v(" "),r("sup",[t._v(t._s(t.$auth.user.groups.length))])]),t._v(" "),r("div",{staticClass:"group__list"},t._l(t.$auth.user.groups,(function(e,o){return r("div",{key:o,staticClass:"group__list-item"},[r("div",{staticClass:"image"},[e.image?r("img",{attrs:{src:e.image,alt:"avatar group"}}):r("img",{attrs:{src:n(955),alt:"avatar group"}})]),t._v(" "),r("div",{staticClass:"name"},[r("nuxt-link",{attrs:{to:"/groups/"+e._id}},[t._v(t._s(e.name))])],1)])})),0)])]):t._e()}),[],!1,null,null,null);e.default=component.exports},978:function(t,e,n){"use strict";n.r(e);var r=n(20),o=(n(64),n(57),{props:{show:{type:Boolean,default:!0}},data:function(){return{infoEvent:{},visible:!1,eventList:[],pageSize:3,current:1}},fetch:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.$store.getters.getEvents.length){e.next=3;break}return e.next=3,t.$store.dispatch("setEvents");case 3:t.showMore();case 4:case"end":return e.stop()}}),e)})))()},computed:{events:function(){return this.$store.getters.getEvents}},methods:{handleShowInfo:function(t){this.infoEvent=t,this.visible=!0},handleCancel:function(){this.infoEvent={}},showMore:function(){var t=this.pageSize*this.current;t>this.events.length?t=this.events.length:this.current+=1,this.eventList=this.events.slice(0,t)}}}),c=n(27),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.show?n("div",{staticClass:"nav-option right"},[n("div",{staticClass:"notification"},[n("div",{staticClass:"title"},[n("nuxt-link",{attrs:{to:"/events"}},[t._v(t._s(t.$t("Thông báo mới")))]),t._v(" "),n("sup",[t._v(t._s(t.eventList.length))])],1),t._v(" "),t.$fetchState.pending?n("a-skeleton",{attrs:{active:"",title:"true"}}):t._l(t.eventList,(function(e,r){return n("div",{key:r,staticClass:"notification__list"},[n("div",{staticClass:"notification__list-item",on:{click:function(n){return t.handleShowInfo(e)}}},[n("div",{staticClass:"status"}),t._v(" "),n("div",{staticClass:"content"},[t._v(t._s(e.title))])])])})),t._v(" "),t.eventList.length<t.events.length?n("p",{staticClass:"show-more",on:{click:t.showMore}},[t._v(t._s(t.$t("Hiển thị thêm")))]):t._e()],2),t._v(" "),n("a-modal",{staticClass:"modal-event",attrs:{title:t.$t("Thông báo"),footer:!1},on:{cancel:t.handleCancel},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[n("template",{slot:"closeIcon"},[n("i",{staticClass:"fal fa-times icon"})]),t._v(" "),n("div",{staticClass:"top"},[t.infoEvent.image&&0!==t.infoEvent.image.length?n("div",{staticClass:"img-event"},[n("img",{attrs:{src:t.infoEvent.image,alt:"image event"}})]):t._e(),t._v(" "),n("div",{staticClass:"top-right"},[n("p",[t._v(t._s(t.infoEvent.title))]),t._v(" "),t.infoEvent.start?n("span",[t._v(" "+t._s(t.infoEvent.start))]):t._e(),t._v(" "),t.infoEvent.end?n("span",[t._v("- "+t._s(t.infoEvent.end))]):t._e()])]),t._v(" "),n("p",[t._v(t._s(t.infoEvent.description))])],2)],1):t._e()}),[],!1,null,null,null);e.default=component.exports},983:function(t,e,n){"use strict";n(975)}}]);