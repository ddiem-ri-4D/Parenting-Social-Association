(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{999:function(e,t,n){"use strict";n.r(t);var r=n(20),o=(n(93),n(94),n(33),n(172),n(64),n(78),n(198),n(57),{layout:"admin",data:function(){return{visibleAdd:!1,activeButtonAdd:!0,fileUser:"",btnLoading:!1,userDuplicate:[],pagination:{pageSize:20},formAdd:{studenID:"",nameChild:"",dob:"",email:"",phone:"",class:""},rules:{studenID:{required:!0,message:"Please enter studenID!"},nameChild:{required:!0,message:"Please enter name child!"},dob:{required:!0,message:"Please enter date of birth!"},email:{required:!0,message:"Please enter username!"},phone:{required:!0,message:"Please enter phone!"},class:{required:!0,message:"Please enter class!"}}}},fetch:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==e.$store.getters.getUsers.length){t.next=3;break}return t.next=3,e.$store.dispatch("setUsers");case 3:case"end":return t.stop()}}),t)})))()},head:function(){return{title:"".concat(this.$t("Phụ huynh")," | Admin")}},computed:{columns:function(){var e=[{title:this.$t("Mã học sinh"),dataIndex:"userID",key:"userID",scopedSlots:{filterDropdown:"filter",filterIcon:"filterIcon"},onFilter:function(e,t){return t.userID.toString().toLowerCase().includes(e.toLowerCase())},sorter:function(a,b){return a.userID.toString().localeCompare(b.userID.toString())}},{title:this.$t("Họ tên"),dataIndex:"userName",key:"userName",scopedSlots:{filterDropdown:"filter",filterIcon:"filterIcon"},onFilter:function(e,t){return t.userName.toString().toLowerCase().includes(e.toLowerCase())},sorter:function(a,b){return a.userName.toString().localeCompare(b.userName.toString())}},{title:this.$t("Tên học sinh"),dataIndex:"nameChild",key:"nameChild",width:"150px",scopedSlots:{filterDropdown:"filter",filterIcon:"filterIcon"},onFilter:function(e,t){return t.nameChild.toString().toLowerCase().includes(e.toLowerCase())},sorter:function(a,b){return a.nameChild.localeCompare(b.nameChild)}},{title:this.$t("Ngày sinh"),dataIndex:"dateOfBirth",key:"dateOfBirth"},{title:this.$t("Email"),dataIndex:"email",key:"email"},{title:this.$t("SDT"),dataIndex:"phone",key:"phone"},{title:this.$t("Lớp"),dataIndex:"class",key:"class",align:"center",sorter:function(a,b){return a.class.toString().localeCompare(b.class.toString())}},{title:this.$t("Quyền"),dataIndex:"role",key:"role"},{title:this.$t("Thao tác"),key:"action",align:"center",scopedSlots:{customRender:"action"}}];return e},users:function(){return this.$store.getters.getUsers.filter((function(e){return"parent"===e.role})).slice().reverse()}},methods:{handleOpenModalAdd:function(){this.visibleAdd=!0},handleCloseModalAdd:function(){this.visibleAdd=!1,this.fileUser="",this.userDuplicate.length=0,this.activeButtonAdd=!0},onSelectChange:function(e,t){},handleSearch:function(e,t,n){t()},handleReset:function(e){e()},dummyRequest:function(e){setTimeout((function(){e.onSuccess("ok")}),0)},handleChangeFile:function(e){"done"===e.file.status&&("application/vnd.ms-excel"===e.file.originFileObj.type?(this.fileUser=e.file.originFileObj,this.activeButtonAdd=!1):this.$notification.open({message:this.$t("Sai định dạng"),description:this.$t("File không đúng định dạng vui lòng kiểm tra lại")}))},handleAddFileUser:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.btnLoading=!0,(n=new FormData).append("file",e.fileUser),t.next=6,e.$axios.$post("/admin/addUsers",n);case 6:r=t.sent,console.log(r),r&&(e.btnLoading=!1,e.handleCloseModalAdd(),e.$store.dispatch("setUsers"),e.$notification.success({message:e.$t("Thêm thành công!")})),t.next=16;break;case 11:t.prev=11,t.t0=t.catch(0),e.$notification.error({message:e.$t("Thêm thất bại!"),description:e.$t("Một hoặc một vài mã tài khoản đã tồn tại, Vui lòng kiểm tra lại")}),e.userDuplicate=t.t0.response.data.userError,e.btnLoading=!1;case 16:case"end":return t.stop()}}),t,null,[[0,11]])})))()},handleAddUser:function(){var e=this;this.$refs.ruleFormAdd.validate((function(t){t&&e.$notification.open({message:e.$t("Chức năng đang phát triển")})}))}}}),l=n(27),component=Object(l.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.$fetchState.pending?n("LoadingView"):n("div",{staticClass:"admin-content"},[n("div",{staticClass:"options"},[n("div",{staticClass:"left"},[n("a-breadcrumb",[n("a-breadcrumb-item",[n("nuxt-link",{attrs:{to:"/admin/dashboard"}},[e._v(e._s(e.$t("Trang chủ")))])],1),e._v(" "),n("a-breadcrumb-item",[e._v(e._s(e.$t("Phụ huynh")))])],1)],1),e._v(" "),n("div",{staticClass:"right"},[n("a-button",{attrs:{type:"primary"},on:{click:e.handleOpenModalAdd}},[n("a-icon",{attrs:{type:"plus"}}),e._v(" "+e._s(e.$t("Thêm phụ huynh"))+" ")],1),e._v(" "),n("a-modal",{staticClass:"modal-admin",attrs:{footer:!1,title:e.$t("Thêm phụ huynh")},on:{cancel:e.handleCloseModalAdd},model:{value:e.visibleAdd,callback:function(t){e.visibleAdd=t},expression:"visibleAdd"}},[n("template",{slot:"closeIcon"},[n("i",{staticClass:"fal fa-times icon"})]),e._v(" "),n("a-tabs",{attrs:{"default-active-key":"1"}},[n("a-tab-pane",{key:"1",attrs:{tab:e.$t("Thêm 1 phụ huynh")}},[n("a-form-model",{ref:"ruleFormAdd",attrs:{model:e.formAdd,rules:e.rules}},[n("a-form-model-item",{ref:"studenID",attrs:{prop:"studenID",label:"studenID"}},[n("a-input",{attrs:{placeholder:"Username",type:"text"},model:{value:e.formAdd.studenID,callback:function(t){e.$set(e.formAdd,"studenID",t)},expression:"formAdd.studenID"}})],1),e._v(" "),n("a-form-model-item",{ref:"nameChild",attrs:{prop:"nameChild"}},[n("a-input",{attrs:{type:"text",placeholder:"Name child"},model:{value:e.formAdd.nameChild,callback:function(t){e.$set(e.formAdd,"nameChild",t)},expression:"formAdd.nameChild"}})],1),e._v(" "),n("a-form-model-item",{ref:"dob",attrs:{prop:"dob"}},[n("a-input",{attrs:{type:"text",placeholder:"Date of birth"},model:{value:e.formAdd.dob,callback:function(t){e.$set(e.formAdd,"dob",t)},expression:"formAdd.dob"}})],1),e._v(" "),n("a-form-model-item",{ref:"email",attrs:{prop:"email"}},[n("a-input",{attrs:{type:"email",placeholder:"Email"},model:{value:e.formAdd.email,callback:function(t){e.$set(e.formAdd,"email",t)},expression:"formAdd.email"}})],1),e._v(" "),n("a-form-model-item",{ref:"phone",attrs:{prop:"phone"}},[n("a-input",{attrs:{type:"text",placeholder:"Chone"},model:{value:e.formAdd.phone,callback:function(t){e.$set(e.formAdd,"phone",t)},expression:"formAdd.phone"}})],1),e._v(" "),n("a-form-model-item",{ref:"class",attrs:{prop:"class"}},[n("a-input",{attrs:{type:"text",placeholder:"Class"},model:{value:e.formAdd.class,callback:function(t){e.$set(e.formAdd,"class",t)},expression:"formAdd.class"}})],1),e._v(" "),n("a-form-model-item",[n("a-button",{attrs:{type:"primary",block:""},on:{click:function(t){return t.preventDefault(),e.handleAddUser.apply(null,arguments)}}},[e._v(" Thêm ")])],1)],1)],1),e._v(" "),n("a-tab-pane",{key:"2",attrs:{tab:e.$t("Thêm bằng file exel"),"force-render":""}},[n("div",[n("a-upload-dragger",{attrs:{"show-upload-list":!1,"custom-request":e.dummyRequest,accept:".csv",name:"file",multiple:!1},on:{change:e.handleChangeFile}},[n("p",{staticClass:"ant-upload-drag-icon"},[n("a-icon",{attrs:{type:"upload"}})],1),e._v(" "),n("p",{staticClass:"ant-upload-text"},[e._v(e._s(e.$t("Bấm để chọn file hoặc kéo thả file vào")))])]),e._v(" "),e.fileUser?n("div",{staticClass:"review-file",staticStyle:{"margin-top":"16px"}},[e._v("\n                "+e._s(e.fileUser.name)+"\n              ")]):e._e(),e._v(" "),e.userDuplicate.length>0?n("div",{staticClass:"user-duplicate"},[n("p",[e._v(e._s(e.$t("Danh sách các mã tài khoản đã tồn tại")))]),e._v(" "),n("div",{staticClass:"list"},e._l(e.userDuplicate,(function(t,r){return n("span",{key:r},[e._v(e._s(t))])})),0)]):e._e(),e._v(" "),n("a-button",{staticStyle:{"margin-top":"16px"},attrs:{type:"primary",disabled:e.activeButtonAdd,block:"",loading:e.btnLoading},on:{click:e.handleAddFileUser}},[e._v("\n                "+e._s(e.$t("Thêm"))+"\n              ")])],1)])],1)],2)],1)]),e._v(" "),n("a-table",{attrs:{bordered:"","row-selection":{onChange:e.onSelectChange},scroll:{x:1300},columns:e.columns,"data-source":e.users,pagination:e.pagination},scopedSlots:e._u([{key:"filter",fn:function(t){var r=t.setSelectedKeys,o=t.selectedKeys,l=t.confirm,d=t.clearFilters,c=t.column;return n("div",{staticClass:"contain-filter"},[n("a-input",{staticClass:"input-search",attrs:{placeholder:"Search name",value:o[0]},on:{pressEnter:function(){return e.handleSearch(o,l,c.dataIndex)},change:function(e){return r(e.target.value?[e.target.value]:[])}}}),e._v(" "),n("a-button",{attrs:{type:"primary",icon:"search",size:"small"},on:{click:function(){return e.handleSearch(o,l,c.dataIndex)}}},[e._v("\n        "+e._s(e.$t("Tìm"))+"\n      ")]),e._v(" "),n("a-button",{attrs:{size:"small"},on:{click:function(t){return e.handleReset(d)}}},[e._v(" "+e._s(e.$t("Hủy"))+" ")])],1)}},{key:"filterIcon",fn:function(e){return n("a-icon",{style:{color:e?"#EA4C89":void 0},attrs:{type:"search"}})}}])},[n("template",{slot:"action"},[n("span",{staticClass:"action"},[n("a-tooltip",{attrs:{placement:"bottom"}},[n("template",{slot:"title"},[n("span",[e._v(e._s(e.$t("Sửa")))])]),e._v(" "),n("a-icon",{attrs:{type:"edit"}})],2)],1),e._v(" "),n("span",{staticClass:"action"},[n("a-tooltip",{attrs:{placement:"bottom"}},[n("template",{slot:"title"},[n("span",[e._v(e._s(e.$t("Xóa")))])]),e._v(" "),n("a-icon",{attrs:{type:"delete"}})],2)],1)])],2)],1)}),[],!1,null,null,null);t.default=component.exports}}]);